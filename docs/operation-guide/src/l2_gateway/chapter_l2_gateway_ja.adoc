[[l2_gateway]]
= L2ゲートウェイのセットアップのことを指します。

本セクションでは、MidoNetのバーチャルブリッジとフィジカルスイッチ間のL2ゲートウェイのセットアップ方法について記載しています。

[IMPORTANT]
現段階では本機能はOpenStack Neutronにまだ実装されていません。よって、L2ゲートウェイを使ってMidoNetネットワーク（またはブリッジ）をNeutronブリッジへと拡張することができません。

*トポロジー*
MidoNetのバーチャルポートブリッジをひとつのVLAN IDで設定することができます。それによって、VLANにタグ付けされているフレームを処理する際のビヘイビアに変更をもたらします。

本ガイドは、VAB（VLAN認識ブリッジ）として、ひとつ、または複数のVLAN設定されたポートをもつブリッジについて言及しています。VABはVLAN IDで設定された複数のバーチャルポートを有していますが、これらのIDは必ずVAB上ではユニークでないといけません。また、VABはいくつかのトランクポート（それはVLANトランクリンクをサポートするよう設定されたポートのことを指します。）を有しています。しかし、高可用性メカニズムが働くため、そのうちひとつだけのポートがアクティブになると想定されます。

本ガイドは、VUB（VLAN非認識ブリッジ）として、VLAN IDで設定されたバーチャルポートがないブリッジについて言及しています。VUBはVABにリンクされているバーチャルポートをひとつだけ有しています。

下記の図が典型的なL2ゲートウェイトポロジーを表しています。

[[l2_gateway_topology]]
.Topology with VLANs and L2 Gateway
image::l2_gateway_topology.png[]

本例にあるVABには、フィジカルインターフェイス（同様の、または異なるフィジカルホスト）につながる二つのトランクポートがあります。それぞれのポートにはフィジカルスイッチへのL2互換性があり、VLANにタグ付けされているトラフィックを通すこともあります。

VABにはその他２つのポートがあり、それぞれ異なるVLAN IDにて設定されます。これらのバーチャルポートは、二つのVUB（VUB-8、またはVUB-5)ピアーとリンクします。そして、二つのバーチャルポートを通して二つのVMと交互にリンクします。

VABは、二つのトランクポートより入ってきた全てのトラフィックのVLANタグを審査します。その他のバーチャルポート（例５または８にあります。）として、同様のVLAN-IDでタグ付けされているフレームに関しては、VABはVLAN-IDを削除し適切なポートへと転送されます。VLAN-IDで設定されたバーチャルポートにあるVABからくるフレームに関しては、VABは該当するVLAN-IDをフレームに加え、ブリッジのMACポートテーブルに基づき、適切なトランクポートへと転送されます。

[NOTE]
NeutronネットワークはVUBに限りマッピングされます。よって、VABにリンクしているVMはOpenStackの外で管理されています。つまり、Neutron内のIPアドレスマネジメントはVAB上のVMに対して使用することができないことを意味します。
