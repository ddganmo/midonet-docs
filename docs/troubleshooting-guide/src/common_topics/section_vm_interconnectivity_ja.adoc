[[vm_interconnectivity]]
= VM の相互接続

++++
<?dbhtml stop-chunking?>
++++

== 状況

VM1 が TCP トラフィックを VM2 に送信できません。
パケットがどこまで到達してから失われたかを特定する必要があります。


== 物理コンピューティングホストを特定する

どの物理コンピューティングホストに VM が配置されているかを調べるには、Horizon に管理ユーザーとしてログインして、インスタンスページに移動します。

VM をリスト内で検索し、コンピューティングホスト、内部 IP、フローティング IP を書き留めておきます。

VM1: compute1, 192.168.0.1, 172.16.0.1

VM2: compute2, 192.168.0.2, 172.16.0.2

== インターフェースを特定する

TAP インターフェース名は、文字列「tap」で始まり、VM のポート UUID の最初の 11 文字が続きます。

VM のポート UUID を特定するには、Horizon で VM のネットワークに移動し、ポートリストで VM の内部 IP
を検索します。そこから、次の例のように TAP インターフェース名を作成します。

ポート UUID: **7aa08012-d0**6c-4c78-aee8-1fff7c063fed

TAP インターフェース: *tap7aa08012-d0*

== インターフェースでトラフィックを検証する

コンピューティングホストの VM の TAP インターフェースで tcpdump を使用すれば、ゲストホストにログインせずに VM の仮想 NIC でトラフィックが確認されているかどうかを検証できます。

[literal,subs="quotes"]
----
# tcpdump -n -i *tap7aa08012-d0*
----

TAP インターフェースでパケットカウンターを監視します。

[literal,subs="quotes"]
----
# watch -d ip -s link show *tap7aa08012-d0*
----
