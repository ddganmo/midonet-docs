<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:exsl="http://exslt.org/common" xmlns:ng="http://docbook.org/docbook-ng" xmlns:fb="http://ogp.me/ns/fb#"><head>
<link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet"/>
<title>Chapter 17. Router Peering - MidoNet Operations Guide
   - 5.1-rev1</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"/><meta name="mavenGroupId" content="org.midonet"/><meta name="mavenArtifactId" content="midonet-docs-operations-guide-en"/><meta name="mavenVersionId" content="5.1-rev1"/><link rel="home" href="index.html" title="MidoNet Operations Guide"/><link rel="up" href="index.html" title="MidoNet Operations Guide"/><link rel="prev" href="service_container_troubleshooting.html" title="Troubleshooting"/><link rel="next" href="mn_cli.html" title="Chapter 18. Working with the MidoNet CLI"/><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="git-sha" content="ba929068e5918f36ad2bc5f0cff14e1a8c72f2cc"/><meta name="buildTime" content="2016-04-04T07:17:14+00:00"/><script type="text/javascript">
            //The id for tree cookie
            var treeCookieId = "treeview-book_operation_guide_en";
            var language = "en";
            var w = new Object();
            //Localization
            txt_filesfound = 'Results';
            txt_enter_at_least_1_char = "You must enter at least one character.";
            txt_browser_not_supported = "Please enable JavaScript.";
            txt_please_wait = "Please wait. Search in progress...";
            txt_results_for = "Results for: ";
        </script><style type="text/css">
            input {
            margin-bottom: 5px;
            margin-top: 2px;
            }

            .folder {
            display: block;
            height: 22px;
            padding-left: 20px;
            background: transparent url(../common/jquery/treeview/images/folder.gif) 0 0px no-repeat;
            }
            
        </style><link rel="shortcut icon" href="../favicon.ico" type="image/x-icon"/><link rel="stylesheet" type="text/css" href="../common/css/positioning.css"/><link rel="stylesheet" type="text/css" href="../common/css/custom.css"/><!--[if IE]>
	<link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
	<![endif]--><link rel="stylesheet" type="text/css" href="../common/jquery/theme-redmond/jquery-ui-1.8.2.custom.css"/><link rel="stylesheet" type="text/css" href="../common/jquery/treeview/jquery.treeview.css"/><script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"><!----></script><script type="text/javascript" src="../common/jquery/jquery-ui-1.8.2.custom.min.js"><!----></script><script type="text/javascript" src="../common/jquery/jquery.cookie.js"><!----></script><script type="text/javascript" src="../common/jquery/treeview/jquery.treeview.min.js"><!----></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/qtip2/2.2.0/jquery.qtip.min.css"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.min.js"><!--jQuery plugin for glossary popups. --></script><script type="text/javascript" src="search/htmlFileList.js"><!----></script><script type="text/javascript" src="search/htmlFileInfoList.js"><!----></script><script type="text/javascript" src="search/nwSearchFnt.js"><!----></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"><!--//make this scalable to other languages as well.--></script><script type="text/javascript" src="search/index-1.js"><!----></script><script type="text/javascript" src="search/index-2.js"><!----></script><script type="text/javascript" src="search/index-3.js"><!----></script><script type="text/javascript">
	    var _gaq = _gaq || [];
	    _gaq.push(['_setAccount', 'UA-56283377-4']);
	    
	    _gaq.push(['_setDomainName', '.midonet.org']);	        
	        </script><script type="text/javascript" src="../common/ga.js"><!----></script></head><body><div id="header"><a onclick="_gaq.push(['_trackEvent', 'Header', 'logo', 'click', 1]);" target="_blank" href="https://www.midonet.org"><img src="../common/images/midonet-logo.png" alt="MidoNet Documentation" width="157" height="47"/></a><h1>Chapter 17. Router Peering</h1><div id="navheader" align="right"><!----><table class="navLinks"><tr><td><a id="showHideButton" onclick="showHideToc(); _gaq.push(['_trackEvent', 'Header', 'show/hide', 'click', 1]);" class="pointLeft" title="Hide TOC tree">Sidebar
                            </a></td><td><a accesskey="p" class="navLinkPrevious" onclick="_gaq.push(['_trackEvent', 'Header', 'prevLink', 'click', 1]);" tabindex="5" href="service_container_troubleshooting.html">Prev</a> 
				  |
                                    <a accesskey="n" class="navLinkNext" onclick="_gaq.push(['_trackEvent', 'Header', 'nextLink', 'click', 1]);" tabindex="5" href="mn_cli.html">Next</a></td></tr></table></div></div><div id="toolbar" class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"><div id="toolbar-left"><p class="breadcrumbs"><a href="https://docs.midonet.org/">MidoNet Manuals</a><a href="index.html">MidoNet Operations Guide
   - 5.1-rev1</a></p><a onclick="_gaq.push(['_trackEvent', 'Header', 'pdfDownload', 'click', 1]);" alt="Download a pdf of this document" class="pdficon" href="../MidoNet_Operations_Guide_EN_5.1-rev1.pdf"><img src="../common/images/pdf.png"/></a><div id="gplusone"><a id="AskOOLink1" href="https://github.com/midonet/midonet/wiki/Communication" target="_blank" title="Questions? Discuss on Mailing Lists or Chat."><i class="icon-question"><!----></i></a>  
        <a id="logABugLink1" href="https://midonet.atlassian.net/browse/MND/" target="_blank" title="Found an error? Report a bug."><i class="icon-bug"><!----></i></a></div></div></div><div id="content"><div class="chapter"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="router_peering"> </a>Chapter 17. Router Peering</h2></div></div></div><div class="toc"><p><strong>Contents</strong></p><dl><dt><span class="section"><a href="router_peering.html#_creating_tenant_networks_and_peer_routers">Creating tenant networks and (peer) routers</a></span></dt><dt><span class="section"><a href="router_peering.html#_creating_a_vtep_router_gateway_device">Creating a VTEP Router Gateway Device</a></span></dt><dt><span class="section"><a href="router_peering.html#_creating_a_multi_site_network_and_l2_gateway_connection">Creating a Multi-site Network and L2 Gateway Connection</a></span></dt><dt><span class="section"><a href="router_peering.html#_peering_a_tenant_router">Peering a Tenant Router</a></span></dt><dt><span class="section"><a href="router_peering.html#_adding_a_remote_mac_entry_endpoint_to_the_multi_site_network">Adding a Remote MAC Entry (Endpoint) to the Multi-site Network</a></span></dt><dt><span class="section"><a href="router_peering.html#_configure_edge_bindings">Configure Edge Bindings</a></span></dt><dt><span class="section"><a href="router_peering.html#_deleting_a_remote_mac_entry">Deleting a Remote MAC Entry</a></span></dt><dt><span class="section"><a href="router_peering.html#_deleting_an_l2_gateway_connection">Deleting an L2 Gateway Connection</a></span></dt><dt><span class="section"><a href="router_peering.html#_deleting_an_l2_gateway">Deleting an L2 Gateway</a></span></dt><dt><span class="section"><a href="router_peering.html#_deleting_a_gateway_device">Deleting a Gateway Device</a></span></dt></dl></div><p>The router peering feature of MidoNet provides overlay connectivity between
multiple sites with VXLAN tunneling. The following section describes the Neutron
CLI and REST API commands to set up router peering. All of the following
operations are executed only by the cloud operator.</p><p>The Neutron APIs defined for the router peering feature are not supported by the
current upstream implementation of Neutron CLI, so they must be executed by
making HTTP requests directly to the Neutron API server.</p><p>The following terminologies are used throughout this document:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">VTEP Router:</p><p class="simpara">Admin owned routers that are VXLAN endpoints in both sites. They are the virtual
gateway devices of each site that enables site-to-site connectivity using VXLAN
technology.</p></li><li class="listitem"><p class="simpara">Gateway Device:</p><p class="simpara">An abstraction of a gateway device in a cloud. A VTEP router is an example of a
gateway device. This abstraction lets us define other types of gateway devices
in the future, such as hardware VTEP.</p></li><li class="listitem"><p class="simpara">Tunnel IPs:</p><p class="simpara">The IP addresses used by the gateway device when constructing VXLAN header (the
outer header). These IP addresses are known only to the gateway devices. It is
also important to note that these are not associated with any particular port,
which allows VXLAN traffic to egress/ingress from any edge router port.</p></li><li class="listitem"><p class="simpara">Multi-Site Network:</p><p class="simpara">Admin-owned network that stretches across multiple sites. Another terminology
used to refer to this network is "Inter-AZ Network". This network contains a
private CIDR allocated for the tenant that emulates a single L2 segment uplink
network of their routers, which in actuality maps to networks across sites (with
the same CIDR).</p></li><li class="listitem"><p class="simpara">Peer Router:</p><p class="simpara">A regular tenant router that connects to the multi-site network. This router
typically already has an external network attached for Internet. In the router
peering scenario, there will be an additional router interface that connects to
the multi-site network.</p></li><li class="listitem"><p class="simpara">Peer Router Port:</p><p class="simpara">A router interface port created on the multi-site network connecting it to the
peer router. These ports on remote sites become the next hops for the local peer
router over the multi-site network to handle traffic for any private tenant
network attached to the peer routers.</p></li><li class="listitem"><p class="simpara">VNI:</p><p class="simpara">A 24-bit VXLAN Network Identifier, which is used to identify a VXLAN network.
Each multi-site network is associated with a VNI (when attaching it to a gateway
device), and currently no two multi-site networks can share a same VNI per
gateway device (but this limitation may be lifted in the future if needed).</p></li><li class="listitem"><p class="simpara">Remote MAC Table:</p><p class="simpara">A table on a gateway device that contains the mappings of VNI, MAC, and tunnel
IP. When a gateway device receives a VXLAN packet, it looks up this table to
determine what the VNI and destination IP address should be on the VXLAN header.
Thus, the MAC address and the tunnel IP are of the remote sites. MAC address
refers to the MAC address assigned to the remote peer router port, which is also
the destination MAC address of the packets ingressing the gateway device before
encapsulation. With this table, coupled with the destination remote MAC address
and the VNI associated with the multi-site network that the packet ingressed
from, we can determine the destination tunnel IP address to use for the VXLAN
header.</p></li><li class="listitem"><p class="simpara">Remote-Site Port:</p><p class="simpara">MidoNet currently does not support broadcast over the cross-site VXLAN overlay
network, which means that ARP does not work across sites. To get around this
temporary limitation, and also to avoid broadcasting in general, we introduce a
concept of a "remote-site" port.  Essentially, when a peer router port is
created in one site, the other site needs to be notified of the IP address and
the MAC address of this port so that it can "seed" the ARP/MAC tables of the
multi-site network to avoid broadcasting ARP. To accomplish this, a special port
of "remote-site" type must be created on all the "remote sites" multi-site
networks.</p></li></ul></div><p>In the following example, there are two sites, Site A and Site B, each with its
own MidoNet and OpenStack deployment. There are two tenants, "admin" and
"tenant", representing the cloud administrator and the tenant using the cloud
service.</p><p>The following setups will be configured:</p><p><span class="strong"><strong>Site A</strong></span></p><p>Tenant Network CIDR: 10.0.0.0/24</p><p>Multi-Site Network (must match in Site B):</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">CIDR: 192.168.0.0/24</li><li class="listitem">VNI: 100</li></ul></div><p>Router Interface Port (Multi-Site Network &lt; - &gt; Peer Router):</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">IP: 192.168.0.1</li><li class="listitem">MAC: 16:B7:B5:A4:57:75</li></ul></div><p>Gateway Device Tunnel IP: 200.200.0.1</p><p><span class="strong"><strong>Site B</strong></span></p><p>Tenant Network CIDR: 10.0.1.0/24</p><p>Multi-Site Network (must match in Site A):</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">CIDR: 192.168.0.0/24</li><li class="listitem">VNI: 100</li></ul></div><p>Router Interface Port (Multi-Site Network &lt; - &gt; Peer Router):</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">IP: 192.168.0.2</li><li class="listitem">MAC: 6F:E4:5A:FA:8E:09</li></ul></div><p>Gateway Device Tunnel IP: 200.200.0.2</p><p>Note that Gateway Device Tunnel IPs are in the same subnet in the example above,
but in practice they do not need to be. They just need to be IP reachable.</p><p>As you will see below, setting up multi-site peering requires a fairly large
number of API operations and coordination among the sites that are mistake
prone. Thus, it is recommended that these steps below are orchestrated and
automated by an external service.</p><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_creating_tenant_networks_and_peer_routers"> </a>Creating tenant networks and (peer) routers</h2></div></div></div><p>Skip this step if you already have a tenant router and a network to do the
peering with. This is here just for completeness.</p><p><span class="strong"><strong>Site A</strong></span></p><pre class="screen"># neutron net-create \
   --tenant-id tenant \
   SiteATenantNetwork</pre><p>Network ID: 14ce01e6-af80-11e5-aca9-6730c321a8c7</p><pre class="screen"># neutron subnet-create \
   --tenant-id tenant \
   14ce01e6-af80-11e5-aca9-6730c321a8c7 \
   10.0.0.0/24</pre><p>Subnet ID: 502b8ae2-af80-11e5-8b7e-137be9ecc435</p><pre class="screen"># neutron router-create \
   --tenant-id tenant \
   SiteATenantRouter</pre><p>Router ID: 93adda04-af80-11e5-a1de-3f0ca86c2c1c</p><pre class="screen"># neutron router-interface-add \
   93adda04-af80-11e5-a1de-3f0ca86c2c1c \
   subnet=502b8ae2-af80-11e5-8b7e-137be9ecc435</pre><p><span class="strong"><strong>Site B</strong></span></p><pre class="screen"># neutron net-create \
   --tenant-id tenant \
   SiteBTenantNetwork</pre><p>Network ID: dd3279be-af80-11e5-a647-67e82f86cba5</p><pre class="screen"># neutron subnet-create \
   --tenant-id tenant \
   dd3279be-af80-11e5-a647-67e82f86cba5 \
   10.0.1.0/24</pre><p>Subnet ID: e253ffb2-af80-11e5-bd02-c36540fab896</p><pre class="screen"># neutron router-create \
   --tenant-id tenant \
   SiteBTenantRouter</pre><p>Router ID: e86e6144-af80-11e5-bf25-8f151b61410e</p><pre class="screen"># neutron router-interface-add \
   e86e6144-af80-11e5-bf25-8f151b61410e \
   subnet=e253ffb2-af80-11e5-bd02-c36540fab896</pre></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_creating_a_vtep_router_gateway_device"> </a>Creating a VTEP Router Gateway Device</h2></div></div></div><p>Any router can be a VTEP router. A router becomes a VTEP router only when it is
registered to be a gateway device as a "router_vtep" type. Note that Neutron CLI
does not support Gateway Device, as well as L2Gateway and L2GatewayConnection
(detailed in the following section), extensions.</p><p><span class="strong"><strong>Site A</strong></span></p><pre class="screen"># neutron router-create \
   --tenant-id admin \
   SiteAVtepRouter</pre><p>Router ID: 4bd9f56e-a792-11e5-b76a-9b045b18900a</p><pre class="literallayout"># POST http://api_server_url/gw/gateway_devices
   '{"gateway_device": {
      "tenant_id": "admin",
      "name": "SiteAGatewayDevice",
      "type": "router_vtep",
      "resource_id": "4bd9f56e-a792-11e5-b76a-9b045b18900a",
      "tunnel_ips": ["200.0.0.1"]}}'</pre><p>Gateway device ID: 5f1a1a9a-a7a2-11e5-8bde-8b2506f539f8</p><p><span class="strong"><strong>Site B</strong></span></p><pre class="screen"># neutron router-create \
   --tenant-id admin \
   SiteBVtepRouter</pre><p>Router ID: 7b0bc88c-af83-11e5-9ec4-bbe5550f7e92</p><pre class="literallayout"># POST http://api_server_url/gw/gateway_devices
   '{"gateway_device": {
      "tenant_id": "admin",
      "name": "SiteBGatewayDevice",
      "type": "router_vtep",
      "resource_id": "7b0bc88c-af83-11e5-9ec4-bbe5550f7e92",
      "tunnel_ips": ["200.0.0.2"]}}'</pre><p>Gateway device ID: 8e47afce-af83-11e5-9b76-4b95f3de9711</p><p>While the <code class="literal">tunnel_ips</code> field of gateway device accepts a list of IP addresses,
in the case of VTEP routers, only one IP address is accepted.</p><p>When using curl commands to do the requests above, the command looks like:</p><pre class="screen"># curl -i -H "Content-type: application/json" -X POST \
   -d `{"foo": {"name": "bar"}}' http://api_server_url/</pre></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_creating_a_multi_site_network_and_l2_gateway_connection"> </a>Creating a Multi-site Network and L2 Gateway Connection</h2></div></div></div><p>The next step is to create a Neutron network that represents an L2 segment that
spans across sites. This network must exist in both sites and must share the
same CIDR and VNI. Also by associating a gateway device to an L2 gateway logical
construct, it becomes an L2 gateway device.</p><p><span class="strong"><strong>Site A</strong></span></p><pre class="screen"># neutron net-create \
   --tenant-id tenant \
   --port-security-enabled=False \
   SiteAMultiSiteNetwork</pre><p>Network ID: 7d107e3a-a7a3-11e5-986c-7b399d0489a5</p><pre class="literallayout"># POST http://api_server_url/l2-gateways
   '{"l2_gateway": {
      "tenant_id": "admin",
      "name": "SiteAL2Gateway",
      "devices": [{"device_id": "5f1a1a9a-a7a2-11e5-8bde-8b2506f539f8"}]}}'</pre><p>L2 Gateway ID: ea57e7e8-a7a4-11e5-89c2-b78c120baeb9</p><pre class="screen"># neutron subnet-create \
   --tenant-id tenant \
   --no-gateway \
   --no-dhcp \
   7d107e3a-a7a3-11e5-986c-7b399d0489a5 \
   192.168.0.0/24</pre><p>Subnet ID: 15f9485c-a7a4-11e5-850b-0b488249b443</p><pre class="literallayout"># POST http://api_server_url/l2-gateway-connections
   '{"l2_gateway_connections": {
      "tenant_id": "admin",
      "network_id": "7d107e3a-a7a3-11e5-986c-7b399d0489a5",
      "segmentation_id": "100",
      "l2_gateway_id": "ea57e7e8-a7a4-11e5-89c2-b78c120baeb9"}}'</pre><p>L2 Gateway Connection ID: b0aef454-a7a5-11e5-8378-b3df9d563488</p><p><span class="strong"><strong>Site B</strong></span></p><pre class="screen"># neutron net-create \
   --tenant-id tenant \
   --port-security-enabled=False \
   SiteBMultiSiteNetwork</pre><p>Network ID: 8943d506-af84-11e5-bb39-e7d07e647dfc</p><pre class="literallayout"># POST http://api_server_url/l2-gateways
   '{"l2_gateway": {
      "tenant_id": "admin",
      "name": "SiteBL2Gateway",
      "devices": [{"device_id": "8e47afce-af83-11e5-9b76-4b95f3de9711"}]}}'</pre><p>L2 Gateway ID: 9514751c-af83-11e5-ac3c-affb2bc390ae</p><pre class="screen"># neutron subnet-create \
   --tenant-id tenant \
   --no-gateway \
   --no-dhcp \
   8943d506-af84-11e5-bb39-e7d07e647dfc \
   192.168.0.0/24</pre><p>Subnet ID: 90e9c6b2-af84-11e5-b12b-af7d2f9c54f7</p><pre class="literallayout"># POST http://api_server_url/l2-gateway-connections
   '{"l2_gateway_connections": {
      "tenant_id": "admin",
      "network_id": "7d107e3a-a7a3-11e5-986c-7b399d0489a5",
      "segmentation_id": "100",
      "l2_gateway_id": "ea57e7e8-a7a4-11e5-89c2-b78c120baeb9"}}'</pre><p>L2 Gateway Connection ID: b0aef454-a7a5-11e5-8378-b3df9d563488</p><p>It is important that you specify <code class="literal">--no-gateway</code> to avoid getting an IP address
reserved for it on this network. Also, you can enable DHCP (remove
<code class="literal">-disable-dhcp</code>) if you plan to launch VMs directly on this network. However, in
that case, be aware that an IP address will be allocated for the DHCP port.</p><p>Mandatory <code class="literal">segmentation_id</code> is the VNI, and it must be in a string format. The
<code class="literal">devices</code> field of l2 gateway is a list, but only one device can be supplied.</p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_peering_a_tenant_router"> </a>Peering a Tenant Router</h2></div></div></div><p>The peering steps begin by attaching the tenant router to the multi-site network
in both sites. Upon attaching the tenant router to the multi-site network, an
extra route must be specified on the tenant router so that the remote private
subnet traffic is routed to the remote peer tenant router.</p><p><span class="strong"><strong>Site A</strong></span></p><pre class="screen"># neutron port-create \
   --tenant-id tenant \
   --fixed-ip ip_address=192.168.0.1 \
   --mac-address="16:B7:B5:A4:57:75" \
   7d107e3a-a7a3-11e5-986c-7b399d0489a5</pre><p>Port ID: 2aae9544-a7aa-11e5-9fcb-1730471db09c</p><pre class="screen"># neutron router-interface-add \
   93adda04-af80-11e5-a1de-3f0ca86c2c1c \
   port=2aae9544-a7aa-11e5-9fcb-1730471db09c</pre><pre class="screen"># neutron router-update \
   93adda04-af80-11e5-a1de-3f0ca86c2c1c \
   --routes type=dict list=true \
   destination=10.0.1.0/24,nexthop=192.168.0.2</pre><p><span class="strong"><strong>Site B</strong></span></p><pre class="screen"># neutron port-create \
   --tenant-id admin \
   --fixed-ip ip_address=192.168.0.2 \
   --mac-address="6F:E4:5A:FA:8E:09" \
   8943d506-af84-11e5-bb39-e7d07e647dfc</pre><p>Port ID: 5f328a1a-af88-11e5-9a2a-3b0fc560e9e7</p><pre class="screen"># neutron router-interface-add \
   e86e6144-af80-11e5-bf25-8f151b61410e \
   port=5f328a1a-af88-11e5-9a2a-3b0fc560e9e7</pre><pre class="screen"># neutron router-update \
   e86e6144-af80-11e5-bf25-8f151b61410e \
   --routes type=dict list=true \
   destination=10.0.0.0/24,nexthop=192.168.0.1</pre><p>In addition, when the router interface port is create in one site, the IP
address and the MAC address of this port must be fed into the other site as
explained in the beginning of the document.</p><p><span class="strong"><strong>Site A</strong></span></p><pre class="screen"># neutron port-create \
   --tenant-id admin \
   --fixed-ip ip_address=192.168.0.2 \
   --mac-address="6F:E4:5A:FA:8E:09" \
   --device-owner "network:remote-site" \
   7d107e3a-a7a3-11e5-986c-7b399d0489a5</pre><p>Port ID: 0bf1e1aa-af8a-11e5-a013-f38f48a84d8b</p><p><span class="strong"><strong>Site B</strong></span></p><pre class="screen"># neutron port-create \
   --tenant-id admin \
   --fixed-ip ip_address=192.168.0.1 \
   --mac-address="16:B7:B5:A4:57:75" \
   --device-owner "network:remote-site" \
   8943d506-af84-11e5-bb39-e7d07e647dfc</pre><p>Port ID: 0ca3a674-af8a-11e5-be73-9369ff5103cc</p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_adding_a_remote_mac_entry_endpoint_to_the_multi_site_network"> </a>Adding a Remote MAC Entry (Endpoint) to the Multi-site Network</h2></div></div></div><p>The last step in configuring peering across sites is by adding remote MAC
entries in the gateway devices' remote MAC tables. These entries tell the
gateway device (and in turn the VTEP router) how to construct the VXLAN header.
 Each entry represents an endpoint in the remote site. In this particular
scenario, it is another VTEP router, but it could be a particular port of a VM
or a router.</p><p>The following request adds a remote MAC entry in the gateway device:</p><p><span class="strong"><strong>Site A</strong></span></p><pre class="literallayout"># POST http://api_server_url/gw/gateway_devices/5f1a1a9a-a7a2-11e5-8bde-8b2506f539f8/remote_mac_entries
   '{"remote_mac_entry":
      {"tenant_id": "admin",
      "vtep_address": "200.200.0.2",
      "mac_address": "6F:E4:5A:FA:8E:09",
      "segmentation_id": "1002}}'</pre><p>Remote MAC Entry ID: 32f2f11c-a7f2-11e5-84a0-0242ac110001</p><p><span class="strong"><strong>Site B</strong></span></p><pre class="literallayout"># POST http://api_server_url/gw/gateway_devices/8e47afce-af83-11e5-9b76-4b95f3de9711/remote_mac_entries
   '{"remote_mac_entry":
      {"tenant_id": "admin",
      "vtep_address": "200.200.0.1",
      "mac_address": "16:B7:B5:A4:57:75",
      "segmentation_id": "100"}}'</pre><p>Remote MAC Entry ID: 4a415f8a-af8a-11e5-aa04-1b22bb4b3872</p></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_configure_edge_bindings"> </a>Configure Edge Bindings</h2></div></div></div><p>At this point, two tenant routers should be peered over VXLAN. To actually get
the traffic in and out, there must be an edge router with its ports bound to the
physical interfaces. Configuration of these edge bindings is out of this
document’s scope, but there are several options to consider:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Use the existing edge router that is serving north-south (Internet) traffic.
In this case, just link the VTEP router to the edge router.</li><li class="listitem">Use a dedicated edge router to handle VTEP traffic. In this case, create a new
edge router, configure its uplinks and connect the VTEP router to this edge
router.</li><li class="listitem">Use the VTEP router as an edge router. This is the most straightforward setup,
where you treat the VTEP router as an edge router and configure uplinks on its
ports directly.</li></ul></div></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_deleting_a_remote_mac_entry"> </a>Deleting a Remote MAC Entry</h2></div></div></div><p><span class="strong"><strong>Site A</strong></span></p><pre class="screen"># DELETE http://api_server_url/gw/gateway_devices/5f1a1a9a-a7a2-11e5-8bde-8b2506f539f8/remote_mac_entries/32f2f11c-a7f2-11e5-84a0-0242ac110001</pre><p><span class="strong"><strong>Site B</strong></span></p><pre class="screen"># DELETE http://api_server_url/gw/gateway_devices/8e47afce-af83-11e5-9b76-4b95f3de9711/remote_mac_entries/4a415f8a-af8a-11e5-aa04-1b22bb4b3872</pre></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_deleting_an_l2_gateway_connection"> </a>Deleting an L2 Gateway Connection</h2></div></div></div><p>The L2 Gateway Connection must be deleted before its associated L2 Gateway is
deleted.</p><p><span class="strong"><strong>Site A</strong></span></p><pre class="screen"># DELETE http://api_server_url/l2-gateway-connections/b0aef454-a7a5-11e5-8378-b3df9d563488</pre><p><span class="strong"><strong>Site B</strong></span></p><pre class="screen"># DELETE http://api_server_url/l2-gateway-connections/acccad4e-af85-11e5-b48e-1b3586917939</pre></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_deleting_an_l2_gateway"> </a>Deleting an L2 Gateway</h2></div></div></div><p>The L2 Gateway must be deleted before its associated Gateway Device is deleted.</p><p><span class="strong"><strong>Site A</strong></span></p><pre class="screen"># DELETE http://api_server_url/l2-gateways/ea57e7e8-a7a4-11e5-89c2-b78c120baeb9</pre><p><span class="strong"><strong>Site B</strong></span></p><pre class="screen"># DELETE http://api_server_url/l2-gateways/9514751c-af83-11e5-ac3c-affb2bc390ae</pre></div><div class="section"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="_deleting_a_gateway_device"> </a>Deleting a Gateway Device</h2></div></div></div><p>By deleting the gateway device associated with the VTEP router, the VTEP router
goes back to being a regular Neutron router.</p><p><span class="strong"><strong>Site A</strong></span></p><pre class="screen"># DELETE http://api_server_url/gw/gateway_devices/5f1a1a9a-a7a2-11e5-8bde-8b2506f539f8</pre><p><span class="strong"><strong>Site B</strong></span></p><pre class="screen"># DELETE http://api_server_url/gw/gateway_devices/8e47afce-af83-11e5-9b76-4b95f3de9711</pre></div></div><script type="text/javascript" src="../common/main.js"><!----></script><div class="logabug" style="text-align: center"><a id="AskOOLink2" href="https://github.com/midonet/midonet/wiki/Communication" target="_blank"><i class="icon-question"><!----></i>Questions? Discuss on Mailing Lists or Chat.</a><br/><a id="logABugLink2" href="https://midonet.atlassian.net/browse/MND/" target="_blank"><i class="icon-bug"><!----></i>Found an error? Report a bug.</a></div><hr/><div id="disqus_thread"><script type="text/javascript">
	      if(window.location.protocol.substring(0,4) == 'http'){
	        var disqus_shortname = 'midonet';
	      
	        var disqus_identifier = 'book_operation_guide_en5.1-rev1router_peering';
	      
	      }
	    </script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><script type="text/javascript" src="../common/comments.js"><!----></script></div><hr/><div class="legal"><a href="index.html">Legal notices</a></div></div><div><div id="leftnavigation" style="padding-top:3px; background-color:white;"><div id="tabs"><ul><li><a href="#treeDiv" tabindex="1"><span class="contentsTab">Contents</span></a></li><li><a href="#searchDiv" tabindex="1"><span class="searchTab">Search</span></a></li></ul><div id="treeDiv"><img src="../common/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;"/><div id="ulTreeDiv" style="display:none" class="thisisthat"><ul id="tree" class="filetree"><li tabindex="2"><span class="file"><a href="preface.html">Preface</a></span><ul><li tabindex="2"><span class="file"><a href="preface.html#_conventions">Conventions</a></span><ul><li tabindex="2"><span class="file"><a href="preface.html#_notices">Notices</a></span></li><li tabindex="2"><span class="file"><a href="preface.html#_command_prompts">Command prompts</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="configuring_uplinks.html">1. Configuring uplinks</a></span><ul><li tabindex="2"><span class="file"><a href="edge_router_setup.html">Edge Router Setup</a></span></li><li tabindex="2"><span class="file"><a href="bgp_setup.html">BGP Setup</a></span><ul><li tabindex="2"><span class="file"><a href="bgp_uplink_configuration.html">BGP Uplink Configuration</a></span></li><li tabindex="2"><span class="file"><a href="bgp_multisession.html">Adding a second session on the same router port</a></span></li><li tabindex="2"><span class="file"><a href="_adding_bgp_sessions_to_a_second_router_port.html">Adding BGP sessions to a second router port</a></span></li><li tabindex="2"><span class="file"><a href="bgp_failover.html">BGP failover configuration on a BGP peer</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="static_setup.html">Static Setup</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="authentication_and_authorization.html">2. Authentication and authorization</a></span><ul><li tabindex="2"><span class="file"><a href="authentication_services.html">Available authentication services in MidoNet</a></span><ul><li tabindex="2"><span class="file"><a href="authentication_services.html#_keystone_authentication">Keystone authentication</a></span></li><li tabindex="2"><span class="file"><a href="authentication_services.html#_mock_authentication">Mock authentication</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html">Using the Keystone authentication service</a></span><ul><li tabindex="2"><span class="file"><a href="keystone_authentication.html#enabling_keystone_authentication">Enabling Keystone authentication</a></span><ul><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_provider_class">cluster.auth.provider_class</a></span></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_admin_role">cluster.auth.admin_role</a></span></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_keystone_version">cluster.auth.keystone.version</a></span></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_keystone_protocol">cluster.auth.keystone.protocol</a></span></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_keystone_host">cluster.auth.keystone.host</a></span></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_keystone_port">cluster.auth.keystone.port</a></span></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_keystone_user_name">cluster.auth.keystone.user_name</a></span></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_keystone_user_password">cluster.auth.keystone.user_password</a></span></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_keystone_admin_token">cluster.auth.keystone.admin_token</a></span></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_keystone_tenant_name">cluster.auth.keystone.tenant_name</a></span></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_keystone_domain_name">cluster.auth.keystone.domain_name</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="keystone_authentication.html#disabling_keystone_authentication">Disabling Keystone authentication</a></span><ul><li tabindex="2"><span class="file"><a href="keystone_authentication.html#_cluster_auth_provider_class_2">cluster.auth.provider_class</a></span></li></ul></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="admitting_resources.html">3. Admitting resources to MidoNet</a></span><ul><li tabindex="2"><span class="file"><a href="tunnel_zones.html">What are tunnel zones?</a></span><ul><li tabindex="2"><span class="file"><a href="create_tunnel_zone.html">Creating tunnel zones</a></span></li><li tabindex="2"><span class="file"><a href="deleting_tunnel_zones.html">Deleting tunnel zones</a></span></li><li tabindex="2"><span class="file"><a href="viewing_tunnel_zone_information.html">Viewing tunnel zone information</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="working_with_hosts.html">Working with hosts</a></span><ul><li tabindex="2"><span class="file"><a href="viewing_host_information.html">Viewing host information</a></span></li><li tabindex="2"><span class="file"><a href="admitting_a_host.html">Admitting a host</a></span></li><li tabindex="2"><span class="file"><a href="removing_a_host_from_a_tunnel_zone.html">Removing a host from a tunnel zone</a></span></li><li tabindex="2"><span class="file"><a href="removing_a_host.html">Removing a host</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="device_abstractions.html">4. Device abstractions</a></span><ul><li tabindex="2"><span class="file"><a href="creating_a_router.html">Creating a router</a></span></li><li tabindex="2"><span class="file"><a href="adding_a_port_to_a_router.html">Adding a port to a router</a></span></li><li tabindex="2"><span class="file"><a href="adding_a_bridge.html">Adding a bridge</a></span></li><li tabindex="2"><span class="file"><a href="adding_a_port_to_a_bridge.html">Adding a port to a bridge</a></span></li><li tabindex="2"><span class="file"><a href="binding_an_exterior_port_to_a_host.html">Binding an exterior port to a host</a></span></li><li tabindex="2"><span class="file"><a href="stateful_port_groups.html">Stateful port groups</a></span><ul><li tabindex="2"><span class="file"><a href="_creating_stateful_port_groups.html">Creating stateful port groups</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="connecting_devices.html">5. Connecting devices</a></span><ul><li tabindex="2"><span class="file"><a href="concept_i13_q4d_q4.html">Connecting a bridge to a router</a></span></li><li tabindex="2"><span class="file"><a href="concept_cpk_t4d_q4.html">Connecting two routers</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="routing.html">6. Routing</a></span><ul><li tabindex="2"><span class="file"><a href="routing_process_overview.html">Routing process overview</a></span><ul><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_source">Source</a></span></li><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_type">Type</a></span></li><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_destination">Destination</a></span></li><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_next_hop_gateway">Next Hop Gateway</a></span></li><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_next_hop_port">Next Hop Port</a></span></li><li tabindex="2"><span class="file"><a href="routing_process_overview.html#_weight">Weight</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="viewing_routes.html">Viewing routes</a></span></li><li tabindex="2"><span class="file"><a href="adding_routes.html">Adding routes</a></span></li><li tabindex="2"><span class="file"><a href="deleting_routes.html">Deleting routes</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="rule_chains.html">7. Rule chains</a></span><ul><li tabindex="2"><span class="file"><a href="packet_flow_within_router.html">A packet’s flow within a router</a></span></li><li tabindex="2"><span class="file"><a href="packet_flow_within_rule_chain.html">A packet’s flow within a rule chain</a></span></li><li tabindex="2"><span class="file"><a href="rule_types.html">Rule types</a></span><ul><li tabindex="2"><span class="file"><a href="rule_types.html#_accept_drop_reject_return">ACCEPT, DROP, REJECT, RETURN</a></span></li><li tabindex="2"><span class="file"><a href="rule_types.html#_dnat_snat">DNAT, SNAT</a></span></li><li tabindex="2"><span class="file"><a href="rule_types.html#_rev_dnat_rev_snat">REV_DNAT, REV_SNAT</a></span></li><li tabindex="2"><span class="file"><a href="rule_types.html#_jump">Jump</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="rule_order.html">Rule order</a></span></li><li tabindex="2"><span class="file"><a href="rule_conditions.html">Rule conditions</a></span><ul><li tabindex="2"><span class="file"><a href="example_condition_1.html">Example condition 1</a></span></li><li tabindex="2"><span class="file"><a href="example_condition_2.html">Example condition 2</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html">MidoNet rule chain examples</a></span><ul><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html#_assumptions">Assumptions</a></span></li><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html#_listing_the_bridges_for_the_tenant">Listing the Bridges for the Tenant</a></span></li><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html#_listing_the_ports_on_the_bridge">Listing the Ports on the Bridge</a></span></li><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html#_listing_the_rules_for_the_inbound_chain_on_a_port">Listing the Rules for the Inbound Chain on a Port</a></span></li><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html#_listing_the_openstack_security_group_rule_chain">Listing the OpenStack Security Group Rule Chain</a></span></li><li tabindex="2"><span class="file"><a href="midonet_rule_chain_example.html#_setting_and_clearing_rule_chains">Setting and clearing Rule Chains</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="network_address_translation.html">8. Network Address Translation</a></span><ul><li tabindex="2"><span class="file"><a href="static_nat.html">Static NAT</a></span><ul><li tabindex="2"><span class="file"><a href="static_nat.html#_assumptions_2">Assumptions</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="nat_rule_chains.html">Viewing NAT rule chain information</a></span><ul><li tabindex="2"><span class="file"><a href="nat_rule_chains.html#_assumptions_3">Assumptions</a></span></li><li tabindex="2"><span class="file"><a href="nat_rule_chains.html#_viewing_a_pre_routing_rule">Viewing a Pre-Routing rule</a></span></li><li tabindex="2"><span class="file"><a href="nat_rule_chains.html#_viewing_a_post_routing_rule">Viewing a Post-Routing rule</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="snat_dnat_revdnat.html">Configuring SNAT, DNAT, and REV_DNAT</a></span></li><li tabindex="2"><span class="file"><a href="dnat_revdnat_example.html">DNAT/REV_DNAT example</a></span></li><li tabindex="2"><span class="file"><a href="snat_example.html">SNAT example</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="l4lb.html">9. Layer 4 Load Balancing</a></span><ul><li tabindex="2"><span class="file"><a href="l4lb_configuration.html">Load balancer configuration</a></span></li><li tabindex="2"><span class="file"><a href="sticky_source_ip.html">Sticky Source IP</a></span></li><li tabindex="2"><span class="file"><a href="health_monitor.html">Health monitor</a></span><ul><li tabindex="2"><span class="file"><a href="_haproxy_configuration.html">HAProxy configuration</a></span></li><li tabindex="2"><span class="file"><a href="_enabling_health_monitoring_in_a_pool.html">Enabling Health Monitoring in a Pool</a></span></li><li tabindex="2"><span class="file"><a href="_disabling_health_monitoring.html">Disabling Health Monitoring</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="l2_address_masking.html">10. L2 address masking</a></span><ul><li tabindex="2"><span class="file"><a href="rule_chain_example.html">L2 address mask rule chain example</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="handling_fragmented_packets.html">11. Handling fragmented packets</a></span><ul><li tabindex="2"><span class="file"><a href="handling_fragmented_packets.html#_definitions_and_allowed_values">Definitions and allowed values</a></span></li><li tabindex="2"><span class="file"><a href="handling_fragmented_packets.html#_fragmented_packets_rule_chain_creation_example">Fragmented packets rule chain creation example</a></span></li><li tabindex="2"><span class="file"><a href="handling_fragmented_packets.html#_non_fragmented_and_fragmented_packets">Non-Fragmented and Fragmented Packets</a></span></li><li tabindex="2"><span class="file"><a href="handling_fragmented_packets.html#_fragmented_and_non_fragmented_packets_with_different_destinations">Fragmented and Non-Fragmented Packets with Different Destinations</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="resource_protection.html">12. MidoNet resource protection</a></span><ul><li tabindex="2"><span class="file"><a href="resource_protection.html#_introduction">Introduction</a></span></li><li tabindex="2"><span class="file"><a href="resource_protection.html#_expected_behavior">Expected Behavior</a></span></li><li tabindex="2"><span class="file"><a href="resource_protection.html#_configuration">Configuration</a></span></li><li tabindex="2"><span class="file"><a href="resource_protection.html#_disabling_resource_protection">Disabling Resource Protection</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="monitoring.html">13. MidoNet monitoring</a></span><ul><li tabindex="2"><span class="file"><a href="metering.html">Metering</a></span><ul><li tabindex="2"><span class="file"><a href="metering.html#_overview">Overview</a></span></li><li tabindex="2"><span class="file"><a href="metering.html#_querying_meters">Querying meters</a></span></li><li tabindex="2"><span class="file"><a href="metering.html#_creating_a_custom_meter">Creating a custom meter</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="nsdb.html">Monitoring Network State Database</a></span><ul><li tabindex="2"><span class="file"><a href="cassandra.html">Cassandra</a></span></li><li tabindex="2"><span class="file"><a href="zookeeper.html">ZooKeeper</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="midolman.html">Monitoring Midolman Agents</a></span></li><li tabindex="2"><span class="file"><a href="events.html">Monitoring events</a></span><ul><li tabindex="2"><span class="file"><a href="configuration.html">Configuration</a></span></li><li tabindex="2"><span class="file"><a href="log_file_locations.html">Event log files locations</a></span></li><li tabindex="2"><span class="file"><a href="message_format.html">Message format</a></span></li><li tabindex="2"><span class="file"><a href="message_categories.html">List of event messages</a></span><ul><li tabindex="2"><span class="file"><a href="topology_events.html">Virtual topology events</a></span><ul><li tabindex="2"><span class="file"><a href="topology_events.html#_router">Router</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_bridge">Bridge</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_port">Port</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_chain">Chain</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_rule">Rule</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_tunnel_zone">Tunnel Zone</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_bgp">BGP</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_loadbalancer">LoadBalancer</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_vip">VIP</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_pool">Pool</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_poolmember">PoolMember</a></span></li><li tabindex="2"><span class="file"><a href="topology_events.html#_healthmonitor">HealthMonitor</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="api_server_events.html">API server events</a></span><ul><li tabindex="2"><span class="file"><a href="api_server_events.html#_nsdb_network_state_database">NSDB (Network State Database)</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="midolman_events.html">MidoNet Agent events</a></span><ul><li tabindex="2"><span class="file"><a href="midolman_events.html#_nsdb">NSDB</a></span></li><li tabindex="2"><span class="file"><a href="midolman_events.html#_interface">Interface</a></span></li><li tabindex="2"><span class="file"><a href="midolman_events.html#_service">Service</a></span></li></ul></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="packet_tracing.html">Packet Tracing</a></span><ul><li tabindex="2"><span class="file"><a href="packet_tracing.html#_usage">Usage</a></span></li><li tabindex="2"><span class="file"><a href="packet_tracing.html#_example">Example</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="port_mirroring.html">Port mirroring</a></span><ul><li tabindex="2"><span class="file"><a href="port_mirroring.html#_mirroring_example">Mirroring example</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="vxlan_configuration.html">14. VXLAN configuration</a></span><ul><li tabindex="2"><span class="file"><a href="vxlan_gateway.html">VXLAN Gateway</a></span></li><li tabindex="2"><span class="file"><a href="vxlan_coordinator.html">VXLAN Coordinator</a></span></li><li tabindex="2"><span class="file"><a href="vxlan_flooding_proxy.html">VXLAN Flooding Proxy</a></span></li><li tabindex="2"><span class="file"><a href="connect_to_vtep.html">Connecting to the VTEP</a></span></li><li tabindex="2"><span class="file"><a href="connect_vtep_to_neutron.html">Setting up a connection between a VTEP and a Neutron network</a></span></li><li tabindex="2"><span class="file"><a href="connect_vtep_to_midonet.html">Enabling connection between VTEP and MidoNet hosts</a></span></li><li tabindex="2"><span class="file"><a href="vxgw_troubleshooting.html">Troubleshooting VTEP/VXGW configuration</a></span></li><li tabindex="2"><span class="file"><a href="vxlan_cli_commands.html">CLI commands used for working with the VXGW</a></span><ul><li tabindex="2"><span class="file"><a href="cli_list_vteps.html">Obtaining a list of VTEPs</a></span></li><li tabindex="2"><span class="file"><a href="cli_add_vtep.html">Adding a VTEP</a></span></li><li tabindex="2"><span class="file"><a href="cli_show_vtep.html">Obtaining information about a VTEP</a></span></li><li tabindex="2"><span class="file"><a href="cli_add_vtep_binding.html">Adding a VTEP binding</a></span></li><li tabindex="2"><span class="file"><a href="cli_list_vtep_bindings.html">Obtaining descriptions of VTEP bindings</a></span></li><li tabindex="2"><span class="file"><a href="cli_remove_vtep_binding.html">Removing a VTEP binding</a></span></li><li tabindex="2"><span class="file"><a href="cli_delete_vtep.html">Deleting a VTEP</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="l2_gateway.html">15. Setting up an L2 gateway</a></span><ul><li tabindex="2"><span class="file"><a href="l2_gateway_configuration.html">Configuring an L2 gateway</a></span></li><li tabindex="2"><span class="file"><a href="l2_gateway_failover.html">Fail-over/Fail-back</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="service_containers.html">16. Service Containers</a></span><ul><li tabindex="2"><span class="file"><a href="service_containers_configuration.html">Configuration</a></span><ul><li tabindex="2"><span class="file"><a href="service_containers_configuration.html#agent_containers_configuration">Agent Configuration</a></span><ul><li tabindex="2"><span class="file"><a href="service_containers_configuration.html#ipsec_containers_configuration">IPSec Containers Configuration</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="service_containers_configuration.html#cluster_containers_configuration">Cluster Configuration</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="service_containers_managament.html">Management</a></span><ul><li tabindex="2"><span class="file"><a href="service_containers_managament.html#_listing_the_service_containers">Listing the Service Containers</a></span></li><li tabindex="2"><span class="file"><a href="service_containers_managament.html#_listing_the_service_container_group">Listing the Service Container Group</a></span></li><li tabindex="2"><span class="file"><a href="service_containers_managament.html#_viewing_the_container_status_message">Viewing the Container Status Message</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="service_container_scheduling.html">Scheduling</a></span><ul><li tabindex="2"><span class="file"><a href="service_container_scheduling.html#service_container_weight">Host Container Weight</a></span></li><li tabindex="2"><span class="file"><a href="service_container_scheduling.html#service_container_scheduling_policies">Scheduling Policies</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="service_container_troubleshooting.html">Troubleshooting</a></span><ul><li tabindex="2"><span class="file"><a href="service_container_troubleshooting.html#service_container_troubleshooting_agent">Agent Troubleshooting</a></span><ul><li tabindex="2"><span class="file"><a href="service_container_troubleshooting.html#_troubleshooting_checklist">Troubleshooting Checklist</a></span></li><li tabindex="2"><span class="file"><a href="service_container_troubleshooting.html#service_container_log">Containers Log</a></span></li><li tabindex="2"><span class="file"><a href="service_container_troubleshooting.html#service_container_logging">Logging the Container Processes</a></span></li></ul></li></ul></li></ul></li><li tabindex="2" id="webhelp-currentid"><span class="file"><a href="router_peering.html">17. Router Peering</a></span><ul><li tabindex="2"><span class="file"><a href="router_peering.html#_creating_tenant_networks_and_peer_routers">Creating tenant networks and (peer) routers</a></span></li><li tabindex="2"><span class="file"><a href="router_peering.html#_creating_a_vtep_router_gateway_device">Creating a VTEP Router Gateway Device</a></span></li><li tabindex="2"><span class="file"><a href="router_peering.html#_creating_a_multi_site_network_and_l2_gateway_connection">Creating a Multi-site Network and L2 Gateway Connection</a></span></li><li tabindex="2"><span class="file"><a href="router_peering.html#_peering_a_tenant_router">Peering a Tenant Router</a></span></li><li tabindex="2"><span class="file"><a href="router_peering.html#_adding_a_remote_mac_entry_endpoint_to_the_multi_site_network">Adding a Remote MAC Entry (Endpoint) to the Multi-site Network</a></span></li><li tabindex="2"><span class="file"><a href="router_peering.html#_configure_edge_bindings">Configure Edge Bindings</a></span></li><li tabindex="2"><span class="file"><a href="router_peering.html#_deleting_a_remote_mac_entry">Deleting a Remote MAC Entry</a></span></li><li tabindex="2"><span class="file"><a href="router_peering.html#_deleting_an_l2_gateway_connection">Deleting an L2 Gateway Connection</a></span></li><li tabindex="2"><span class="file"><a href="router_peering.html#_deleting_an_l2_gateway">Deleting an L2 Gateway</a></span></li><li tabindex="2"><span class="file"><a href="router_peering.html#_deleting_a_gateway_device">Deleting a Gateway Device</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="mn_cli.html">18. Working with the MidoNet CLI</a></span><ul><li tabindex="2"><span class="file"><a href="mn_cli_usage.html">Using the MidoNet CLI</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="advanced_configuration_and_concepts.html">19. Advanced configuration and concepts</a></span><ul><li tabindex="2"><span class="file"><a href="midonet_config.html">MidoNet Configuration: mn-conf</a></span><ul><li tabindex="2"><span class="file"><a href="_bootstrapping.html">Bootstrapping</a></span></li><li tabindex="2"><span class="file"><a href="_configuration_sources.html">Configuration sources</a></span></li><li tabindex="2"><span class="file"><a href="_mn_conf_man_page.html">mn-conf man page</a></span><ul><li tabindex="2"><span class="file"><a href="_mn_conf_man_page.html#_options_list">OPTIONS LIST</a></span></li><li tabindex="2"><span class="file"><a href="_mn_conf_man_page.html#_description">DESCRIPTION</a></span></li><li tabindex="2"><span class="file"><a href="_mn_conf_man_page.html#_configuration_format">CONFIGURATION FORMAT</a></span></li><li tabindex="2"><span class="file"><a href="_mn_conf_man_page.html#_subcommands">SUBCOMMANDS</a></span></li><li tabindex="2"><span class="file"><a href="_mn_conf_man_page.html#_miscellaneous_options">MISCELLANEOUS OPTIONS</a></span></li><li tabindex="2"><span class="file"><a href="_mn_conf_man_page.html#_examples">EXAMPLES</a></span></li><li tabindex="2"><span class="file"><a href="_mn_conf_man_page.html#_files">FILES</a></span></li><li tabindex="2"><span class="file"><a href="_mn_conf_man_page.html#_environment">ENVIRONMENT</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="recommended_configurations.html">Recommended configurations</a></span><ul><li tabindex="2"><span class="file"><a href="recommended_configurations.html#_overview_of_performance_impacting_configuration_options">Overview of Performance-Impacting Configuration Options</a></span></li><li tabindex="2"><span class="file"><a href="recommended_configurations.html#_recommended_values">Recommended Values</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html">MidoNet Agent (Midolman) configuration options</a></span><ul><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html#_midonet_behavior_after_zookeeper_cluster_failure">MidoNet behavior after ZooKeeper cluster failure</a></span></li><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html#_zookeeper_configuration">ZooKeeper configuration</a></span></li><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html#_cassandra_configuration">Cassandra configuration</a></span></li><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html#_datapath_configuration">Datapath configuration</a></span></li><li tabindex="2"><span class="file"><a href="midolman_configuration_options.html#_bgp_failover_configuration">BGP failover configuration</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="api_configuration_options.html">Advanced MidoNet REST API configuration options</a></span><ul><li tabindex="2"><span class="file"><a href="api_configuration_options.html#_configuration_options">Configuration options</a></span></li><li tabindex="2"><span class="file"><a href="api_configuration_options.html#_specifying_the_private_and_public_keys_for_https">Specifying the private and public keys for HTTPS</a></span></li><li tabindex="2"><span class="file"><a href="api_configuration_options.html#_generating_self_signed_keys">Generating self-signed keys</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="cassandra_cache.html">Cassandra cache</a></span><ul><li tabindex="2"><span class="file"><a href="midolman_behavior_on_cassandra_failure.html">Agent behavior on node failure</a></span></li><li tabindex="2"><span class="file"><a href="nsdb_connectivity.html">Network State Database connectivity</a></span><ul><li tabindex="2"><span class="file"><a href="nsdb_connectivity.html#_zookeeper_zookeeper_hosts">zookeeper-zookeeper_hosts</a></span></li><li tabindex="2"><span class="file"><a href="nsdb_connectivity.html#_zookeeper_session_timeout">zookeeper-session_timeout</a></span></li></ul></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="service_ports.html">20. MidoNet and OpenStack TCP/UDP service ports</a></span><ul><li tabindex="2"><span class="file"><a href="controller_node_services.html">Services on the Controller node</a></span></li><li tabindex="2"><span class="file"><a href="nsdb_node_services.html">Services on the Network State Database nodes</a></span></li><li tabindex="2"><span class="file"><a href="compute_node_services.html">Services on the Compute nodes</a></span></li><li tabindex="2"><span class="file"><a href="gateway_node_services.html">Services on the Gateway Nodes</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="backup_restore.html">21. Backup / Restore</a></span><ul><li tabindex="2"><span class="file"><a href="backup_zookeeper.html">ZooKeeper</a></span><ul><li tabindex="2"><span class="file"><a href="backup_zookeeper.html#_backup">Backup</a></span></li><li tabindex="2"><span class="file"><a href="backup_zookeeper.html#_restore">Restore</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="backup_cassandra.html">Cassandra</a></span><ul><li tabindex="2"><span class="file"><a href="backup_cassandra.html#_backup_2">Backup</a></span></li><li tabindex="2"><span class="file"><a href="backup_cassandra.html#_restore_2">Restore</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="backup_midolman.html">MidoNet Agent</a></span><ul><li tabindex="2"><span class="file"><a href="backup_midolman.html#_backup_3">Backup</a></span></li><li tabindex="2"><span class="file"><a href="backup_midolman.html#_restore_3">Restore</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="backup_cluster.html">MidoNet Cluster</a></span><ul><li tabindex="2"><span class="file"><a href="backup_cluster.html#_backup_4">Backup</a></span></li><li tabindex="2"><span class="file"><a href="backup_cluster.html#_restore_4">Restore</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="backup_mysql.html">MySQL / MariaDB</a></span><ul><li tabindex="2"><span class="file"><a href="backup_mysql.html#_backup_5">Backup</a></span></li><li tabindex="2"><span class="file"><a href="backup_mysql.html#_restore_5">Restore</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="backup_neutron.html">Neutron</a></span><ul><li tabindex="2"><span class="file"><a href="backup_neutron.html#_backup_6">Backup</a></span></li><li tabindex="2"><span class="file"><a href="backup_neutron.html#_restore_6">Restore</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="backup_libvirt.html">Libvirt</a></span><ul><li tabindex="2"><span class="file"><a href="backup_libvirt.html#_backup_7">Backup</a></span></li><li tabindex="2"><span class="file"><a href="backup_libvirt.html#_restore_7">Restore</a></span></li></ul></li></ul></li></ul></div></div><div id="searchDiv"><div id="search"><form onsubmit="Verifie(ditaSearch_Form);return false" name="ditaSearch_Form" class="searchForm"><fieldset class="searchFieldSet"><legend>Search</legend><center><input id="textToSearch" name="textToSearch" type="text" class="searchText"/> &nbsp; <input onclick="Verifie(ditaSearch_Form)" type="button" class="searchButton" value="Go" id="doSearch"/></center></fieldset></form></div><div id="searchResults"><center/></div><p class="searchHighlight"><a href="#" onclick="toggleHighlight()">Search Highlighter (On/Off)</a></p></div></div></div></div></body></html>